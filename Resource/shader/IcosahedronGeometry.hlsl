#include "Icosahedron.hlsli"

//’¸“_
static const float3 vertexs[60] =
{
float3(0.425325, 0.138197, -0.223607),
float3(0.0, 0.0, -0.5),
float3(0.0, 0.447214, -0.223607),
float3(0.262866, -0.361803, -0.223607),
float3(0.0, 0.0, -0.5),
float3(0.425325, 0.138197, -0.223607),
float3(-0.262866, -0.361803, -0.223607),
float3(0.0, 0.0, -0.5),
float3(0.262866, -0.361803, -0.223607),
float3(-0.425325, 0.138197, -0.223607),
float3(0.0, 0.0, -0.5),
float3(-0.262866, -0.361803, -0.223607),
float3(0.0, 0.447214, -0.223607),
float3(0.0, 0.0, -0.5),
float3(-0.425325, 0.138197, -0.223607),
float3(-0.262866, 0.361803, 0.223607),
float3(0.0, 0.447214, -0.223607),
float3(-0.425325, 0.138197, -0.223607),
float3(-0.425325, -0.138197, 0.223607),
float3(-0.425325, 0.138197, -0.223607),
float3(-0.262866, -0.361803, -0.223607),
float3(0.0, -0.447214, 0.223607),
float3(-0.262866, -0.361803, -0.223607),
float3(0.262866, -0.361803, -0.223607),
float3(0.425325, -0.138197, 0.223607),
float3(0.262866, -0.361803, -0.223607),
float3(0.425325, 0.138197, -0.223607),
float3(0.262866, 0.361803, 0.223607),
float3(0.425325, 0.138197, -0.223607),
float3(0.0, 0.447214, -0.223607),
float3(0.262866, 0.361803, 0.223607),
float3(0.0, 0.447214, -0.223607),
float3(-0.262866, 0.361803, 0.223607),
float3(-0.262866, 0.361803, 0.223607),
float3(-0.425325, 0.138197, -0.223607),
float3(-0.425325, -0.138197, 0.223607),
float3(-0.425325, -0.138197, 0.223607),
float3(-0.262866, -0.361803, -0.223607),
float3(0.0, -0.447214, 0.223607),
float3(0.0, -0.447214, 0.223607),
float3(0.262866, -0.361803, -0.223607),
float3(0.425325, -0.138197, 0.223607),
float3(0.425325, -0.138197, 0.223607),
float3(0.425325, 0.138197, -0.223607),
float3(0.262866, 0.361803, 0.223607),
float3(-0.262866, 0.361803, 0.223607),
float3(0.0, 0.0, 0.5),
float3(0.262866, 0.361803, 0.223607),
float3(0.262866, 0.361803, 0.223607),
float3(0.0, 0.0, 0.5),
float3(0.425325, -0.138197, 0.223607),
float3(0.425325, -0.138197, 0.223607),
float3(0.0, 0.0, 0.5),
float3(0.0, -0.447214, 0.223607),
float3(0.0, -0.447214, 0.223607),
float3(0.0, 0.0, 0.5),
float3(-0.425325, -0.138197, 0.223607),
float3(-0.425325, -0.138197, 0.223607),
float3(0.0, 0.0, 0.5),
float3(-0.262866, 0.361803, 0.223607)
};

//–@ü
static const float3 normals[20] =
{
float3(0.356822,0.491124,-0.794654),
float3(0.577351,-0.187592,-0.794654),
float3(0.0,-0.607062,-0.794654),
float3(-0.577351,-0.187592,-0.794654),
float3(-0.356822,0.491124,-0.794654),
float3(-0.57735,0.794655,-0.187593),
float3(-0.934172,-0.303531,-0.187593),
float3(-0.0,-0.982247,-0.187593),
float3(0.934172,-0.303531,-0.187593),
float3(0.57735,0.794655,-0.187593),
float3(0.0,0.982247,0.187593),
float3(-0.934172,0.303531,0.187593),
float3(-0.57735,-0.794655,0.187593),
float3(0.57735,-0.794655,0.187593),
float3(0.934172,0.303531,0.187593),
float3(-0.0,0.607062,0.794654),
float3(0.577351,0.187592,0.794654),
float3(0.356822,-0.491124,0.794654),
float3(-0.356822,-0.491124,0.794654),
float3(-0.577351,0.187592,0.794654),
};

[maxvertexcount(60)]
void main(
    point VSOutput input[1],
    inout TriangleStream< GSOutput > output
)
{
    GSOutput element;
    const float Rad = input[0].Radius * 2;

    [unroll]
    for (int j = 0; j < 20; j++)
    {
        [unroll]
        for (int k = 0; k < 3; k++)
        {
            const int vid = j * 3 + k;
            element.svpos = float4(vertexs[vid].x * Rad, vertexs[vid].y * Rad, vertexs[vid].z * Rad, 0.0);
            element.svpos = element.svpos + input[0].pos;
            element.normal = normals[j];

            element.color = input[0].color;
            element.svpos = mul(mat, element.svpos);
            element.Lighting = input[0].Lighting;

            output.Append(element);
        }
        output.RestartStrip();
    }
}